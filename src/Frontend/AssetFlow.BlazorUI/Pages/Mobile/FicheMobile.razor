@* ============================================================
   Pages/Mobile/FicheMobile.razor
   
   Page PUBLIQUE — aucune authentification requise.
   Accessible via l'URL encodée dans le QR Code :
     http://votreapp.com/fiche/{affectationId}
   
   Optimisée pour lecture sur smartphone :
   - Layout pleine largeur, 1 colonne
   - Grands caractères, bonne lisibilité
   - Dark mode automatique (suit préférence OS)
   - CSS isolé, zéro dépendance externe
   ============================================================ *@

@page "/fiche/{AffectationId:int}"
@using AssetFlow.BlazorUI.Services

@* PAS de @attribute [Authorize] — page publique *@

<div class="fiche-page">

    @* ── En-tête de marque ── *@
    <header class="fiche-header">
        <div class="fiche-brand">
            <div class="fiche-brand-icon">
                <svg viewBox="0 0 24 24">
                    <path d="M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z"/>
                    <path d="M7 7h.01"/>
                </svg>
            </div>
            <div>
                <p class="fiche-brand-name">AssetFlow</p>
                <p class="fiche-brand-sub">Fiche d'équipement</p>
            </div>
        </div>
        @if (Equipement != null)
        {
            <span class="fiche-statut fiche-statut-@Equipement.Statut.ToLower()">
                <span class="fiche-statut-dot"></span>
                @GetStatutLabel(Equipement.Statut)
            </span>
        }
    </header>

    @* ── Contenu ── *@
    <main class="fiche-main">

        @if (IsLoading)
        {
            <div class="fiche-loading">
                <div class="fiche-spinner"></div>
                <p>Chargement...</p>
            </div>
        }
        else if (Equipement == null)
        {
            <div class="fiche-error">
                <svg viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="m15 9-6 6M9 9l6 6"/>
                </svg>
                <h3>Fiche introuvable</h3>
                <p>Cet équipement n'existe pas ou a été retiré du système.</p>
            </div>
        }
        else
        {
            @* Photo *@
            @if (!string.IsNullOrEmpty(Equipement.ImageUrl))
            {
                <div class="fiche-photo-wrap">
                    <img class="fiche-photo" src="@Equipement.ImageUrl" alt="@Equipement.Designation"/>
                </div>
            }

            @* Nom + référence *@
            <div class="fiche-identity">
                <h1 class="fiche-title">@Equipement.Designation</h1>
                <p class="fiche-ref">@Equipement.Reference</p>
            </div>

            @* Grille de spécifications *@
            <div class="fiche-specs">

                <div class="spec-row">
                    <div class="spec-item">
                        <span class="spec-item-label">Catégorie</span>
                        <span class="spec-item-value">@Equipement.Categorie</span>
                    </div>
                    <div class="spec-item">
                        <span class="spec-item-label">État</span>
                        <span class="spec-item-value">
                            <span class="etat-tag etat-@Equipement.Statut.ToLower()">
                                @GetStatutLabel(Equipement.Statut)
                            </span>
                        </span>
                    </div>
                </div>

                <div class="spec-row">
                    <div class="spec-item">
                        <span class="spec-item-label">Date d'affectation</span>
                        <span class="spec-item-value">
                            @Equipement.DateAffectation.ToString("dd MMM yyyy")
                        </span>
                    </div>
                    <div class="spec-item">
                        <span class="spec-item-label">Quantité</span>
                        <span class="spec-item-value">@Equipement.QuantiteAffectee pièce(s)</span>
                    </div>
                </div>

                @if (!string.IsNullOrEmpty(Equipement.Observations))
                {
                    <div class="spec-full">
                        <span class="spec-item-label">Observations</span>
                        <span class="spec-item-value spec-obs">@Equipement.Observations</span>
                    </div>
                }
            </div>

            @* Info de scan *@
            <div class="fiche-scan-info">
                <svg viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="8" x2="12" y2="12"/>
                    <line x1="12" y1="16" x2="12.01" y2="16"/>
                </svg>
                <p>Fiche consultée via QR Code · ID affectation #@AffectationId</p>
            </div>
        }

    </main>

    @* ── Pied de page ── *@
    <footer class="fiche-footer">
        <p>AssetFlow — Système de gestion d'inventaire</p>
        <p>Accès via QR Code — Page publique</p>
    </footer>

</div>
